# 监听器

专门用于对其他对象身上发生的事件或状态改变进行监听和相应处理的对象，当被监视的对象发生情况时，立即采取相应的行动。

servlet监听器：用于web应用的ServletContext, HttpSession, ServletRequest等域对象的创建与销毁事件，以及监听这些与对象中的属性发生修改的事件

## 分类
- 监听域对象自身的创建和销毁的事件监听器
- 监听域对象中的属性的增加和删除的事件监听器
- 监听绑定到 HttpSession 域中的某个对象的状态的事件监听器

## 监听域对象的创建和销毁

| |创建时机|销毁时机|
|--|--|--|
|ServletContext|web服务器启动时为每个web应用程序创建相应的ServletContext对象|web服务器关闭时为每个web应用程序销毁相应的ServletContext对象
|HttpSession|浏览器开始与服务器会话时创建|调用HttpSession.invalidate()或超过session的最大有效事件间隔或服务器进程被停止|
|ServletRequest|每次请求开始时创建|每次访问结束后销毁|

## 创建监听器

Servlet 规范为每种事件监听器都定义了相应的接口，开发人员编写的事件监听器程序只需实现这些对应的接口

### 实现ServletContextListener接口
	
- 监听ServletContext对象被创建或销毁的Servlet监听器

```java
// 当ServletContext对象被创建时(即当前web应用加载的时候)，Servlet容器调用该方法
default void contextInitialized(ServletContextEvent sce)
// 当ServletContext对象被销毁时(即当前web应用卸载的时候)，Servlet容器调用该方法
default void contextDestroyed(ServletContextEvent sce)

//ServletContextEvent类中的方法获取ServletContext对象
public ServletContext getServletContext()
```

- 在web.xml文件中配置Listener

```xml
<listener>
	<!-- 填listener所在详细路径 -->
	<listener-class>...</listener-class>
</listener>
```

- 用途：ServletContextListener是最常用的Listener，可以在当前web应用被加载时对当前web应用相关资源进行初始化操作：创建数据库链接，创建Spring的IOC容器，读取当前web应用的初始化参数

### 实现HttpSessionListener接口&ServletRequestListener接口

与ServletContextListener类似

**HttpSeesionListener**

```java
default void sessionCreated(HttpSessionEvent se)
default void sessionDestroyed(HttpSessionEvent se)

// 通过HttpSessionEvent类中方法获取HttpSession对象
public HttpSession getSession()
```

**ServletRequestListener**

```java
default void requestDestroyed(ServletRequestEvent sre)
default void requestInitialized(ServletRequestEvent sre)

// 通过ServletRequestEvent类中方法获取ServletRequest和ServeltContext对象
public ServletRequest getServletRequest()
public ServletContext getServletContext()
```

## 通过监听器进一步了解request, 

request是一个请求，当发送一个请求时创建，进入一个地址就会创建一个request对象，并销毁；当在此页面转发到另一个页面的时候会再次创建一个request对象；而如果是重定向到另一个页面，会先创建一个request对象请求重定向